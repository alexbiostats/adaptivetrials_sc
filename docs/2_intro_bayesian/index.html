<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Alex Kaizer - Bayesian 101</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/academicons-1.9.2/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/academicons-1.9.2/size.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/academicons-1.9.1/css/academicons.css" rel="stylesheet">

<link rel="icon" type="image/png" href="./files/favicon.ico">

<script type="text/javascript">
function setBrand() {
document.getElementsByClassName("navbar-brand")[0].href="https://www.alexkaizer.com";
}
window.onload = setBrand;
</script>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-5PBG7BL207"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-5PBG7BL207');
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Alex Kaizer</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-short-course" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Short Course</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-short-course">    
        <li>
    <a class="dropdown-item" href="../0_intro" rel="" target="">
 <span class="dropdown-text">Intro and Welcome</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../1_intro_clinical_trials" rel="" target="">
 <span class="dropdown-text">Basics of Clinical Trials</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../2_intro_bayesian" rel="" target="">
 <span class="dropdown-text">Bayesian 101</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../3_interim_monitoring" rel="" target="">
 <span class="dropdown-text">Interim Monitoring</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../4_sample_size_reestimation" rel="" target="">
 <span class="dropdown-text">Sample Size Re-Estimation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../5_adaptive_enrichment" rel="" target="">
 <span class="dropdown-text">Adaptive Enrichment</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../6_treatment_arm_selection" rel="" target="">
 <span class="dropdown-text">Treatment Arm Selection</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../7_adaptive_randomization" rel="" target="">
 <span class="dropdown-text">Adaptive Randomization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../8_bayesian_information_sharing" rel="" target="">
 <span class="dropdown-text">Bayesian Information Sharing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../9_master_protocols" rel="" target="">
 <span class="dropdown-text">Master Protocols</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../10_seamless_designs" rel="" target="">
 <span class="dropdown-text">Seamless Designs</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:alex.kaizer@cuanschutz.edu" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://scholar.google.com/citations?user=ICpH74EAAAAJ&amp;hl=en" rel="" target="">
 <span class="menu-text"><i class="ai  ai-google-scholar ai-large"></i></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="http://github.com/alexbiostats" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.alexkaizer.com/files/Alex_CV.pdf" rel="" target="">
 <span class="menu-text"><i class="ai  ai-cv ai-large"></i></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/alex-kaizer/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#slide-deck" id="toc-slide-deck" class="nav-link" data-scroll-target="#slide-deck">Slide Deck</a></li>
  <li><a href="#code-examples-in-r" id="toc-code-examples-in-r" class="nav-link" data-scroll-target="#code-examples-in-r">Code Examples in R</a>
  <ul class="collapse">
  <li><a href="#software-options" id="toc-software-options" class="nav-link" data-scroll-target="#software-options">Software Options</a></li>
  <li><a href="#linear-regression-code-from-a-practical-guide-to-adopting-bayesian-analyses-in-clinical-research" id="toc-linear-regression-code-from-a-practical-guide-to-adopting-bayesian-analyses-in-clinical-research" class="nav-link" data-scroll-target="#linear-regression-code-from-a-practical-guide-to-adopting-bayesian-analyses-in-clinical-research">Linear Regression Code from “A practical guide to adopting Bayesian analyses in clinical research”</a>
  <ul class="collapse">
  <li><a href="#frequentist-simple-linear-regression" id="toc-frequentist-simple-linear-regression" class="nav-link" data-scroll-target="#frequentist-simple-linear-regression">Frequentist Simple Linear Regression</a></li>
  <li><a href="#brms-bayesian-simple-linear-regression-syntax" id="toc-brms-bayesian-simple-linear-regression-syntax" class="nav-link" data-scroll-target="#brms-bayesian-simple-linear-regression-syntax">brms Bayesian Simple Linear Regression Syntax</a></li>
  <li><a href="#brms-slr-with-pseudo-vague-prior" id="toc-brms-slr-with-pseudo-vague-prior" class="nav-link" data-scroll-target="#brms-slr-with-pseudo-vague-prior">brms SLR with Pseudo Vague Prior</a></li>
  <li><a href="#brms-slr-with-vague-prior" id="toc-brms-slr-with-vague-prior" class="nav-link" data-scroll-target="#brms-slr-with-vague-prior">brms SLR with Vague Prior</a></li>
  <li><a href="#brms-slr-with-optimistic-prior" id="toc-brms-slr-with-optimistic-prior" class="nav-link" data-scroll-target="#brms-slr-with-optimistic-prior">brms SLR with Optimistic Prior</a></li>
  <li><a href="#brms-slr-with-skeptical-prior" id="toc-brms-slr-with-skeptical-prior" class="nav-link" data-scroll-target="#brms-slr-with-skeptical-prior">brms SLR with Skeptical Prior</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Bayesian 101</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>Overview</h1>
<p>This module covers a crash course in Bayesian statistics. While many adaptive trial elements can be done with frequentist methods, Bayesian methods provide additional flexibility. We will introduce the basics of the Bayesian approach to statistics and cover a brief example analysis of a clinical trial using Bayesian methods.</p>
</section>
<section id="slide-deck" class="level1">
<h1>Slide Deck</h1>
<iframe class="speakerdeck-iframe" style="border: 0px; background: rgba(0, 0, 0, 0.1) padding-box; margin: 0px; padding: 0px; border-radius: 6px; box-shadow: rgba(0, 0, 0, 0.2) 0px 5px 40px; width: 100%; height: auto; aspect-ratio: 560 / 315;" frameborder="0" src="https://speakerdeck.com/player/9e2562ed178d47419175ba3647883c01" title="Bayesian 101" allowfullscreen="true" data-ratio="1.7777777777777777">
</iframe>
<p>&nbsp;</p>
<p>You can also download the <a href="../files/Slides/2_intro_bayesian.pptx">original PowerPoint file</a>.</p>
</section>
<section id="code-examples-in-r" class="level1">
<h1>Code Examples in R</h1>
<section id="software-options" class="level2">
<h2 class="anchored" data-anchor-id="software-options">Software Options</h2>
<p>There are lots of statistical packages and approaches that we can use to either run Bayesian models in R, or to connect R with external software to implement the models. Some options include:</p>
<ul>
<li><a href="https://paul-buerkner.github.io/brms/"><code>brms</code> package</a>: implements the Stan programming language within R, syntax is similar to the <code>lme4</code> package, this is our focus for Bayesian examples</li>
<li><a href="https://mc-stan.org/users/interfaces/rstan"><code>rstan</code> and <code>rstanarm</code> packages</a>: implements the Stan programming language within R, <code>rstanarm</code> uses standard <code>glm</code> syntax, runs more quickly than <code>brms</code> since models are pre-compiled</li>
<li><a href="https://easystats.github.io/bayestestR/"><code>bayestestr</code> package</a>: can provide Bayes factors and works with <code>rstanarm</code>, <code>brms</code>, and <code>BayesFactor</code></li>
<li><a href="https://cran.r-project.org/web/packages/R2jags/index.html"><code>R2jags</code></a>, <a href="https://cran.r-project.org/web/packages/rjags/index.html"><code>rjags</code></a>, <a href="https://cran.r-project.org/web/packages/runjags/index.html"><code>runjags</code></a> packages: implements <a href="https://mcmc-jags.sourceforge.io/">JAGS (just another Gibbs sampler)</a> which allows for non-gradient sampling, JAGS is one of the “original” approaches for implementing Bayesian analyses via software (that I remember), can be a little clunkier than other options</li>
</ul>
<p>It is worth noting that within each software distributions may use different parameterizations, so caution should be taken to ensure the desired prior values are used. For example, the normal distribution in JAGS uses the precision (i.e., <span class="math inline">\(\tau = \frac{1}{\sigma^2}\)</span>), whereas Stan uses the standard deviation (i.e., <span class="math inline">\(\sigma\)</span>).</p>
<p>Dr.&nbsp;Kruschke has a nice introduction to Bayesian textbook that includes some <a href="https://sites.google.com/site/doingbayesiandataanalysis/software-installation">instructions for installing software for Bayesian analyses</a>. You may also be interested in exploring the textbook for more background on Bayesian theory, methods, and implementation.</p>
<p>Additionally, Stata and SAS (e.g., PROC MCMC and PROC GENMOD) include Bayesian options. These are detailed in <a href="https://www.cambridge.org/core/journals/journal-of-clinical-and-translational-science/article/practical-guide-to-adopting-bayesian-analyses-in-clinical-research/CF6C017318CD5431C98EEFE37DBB6063?utm_campaign=shareaholic&amp;utm_medium=copy_link&amp;utm_source=bookmark">“A practical guide to adopting Bayesian analyses in clinical research”</a> for step-by-step guidance on their implementation.</p>
</section>
<section id="linear-regression-code-from-a-practical-guide-to-adopting-bayesian-analyses-in-clinical-research" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-code-from-a-practical-guide-to-adopting-bayesian-analyses-in-clinical-research">Linear Regression Code from <a href="https://www.cambridge.org/core/journals/journal-of-clinical-and-translational-science/article/practical-guide-to-adopting-bayesian-analyses-in-clinical-research/CF6C017318CD5431C98EEFE37DBB6063?utm_campaign=shareaholic&amp;utm_medium=copy_link&amp;utm_source=bookmark">“A practical guide to adopting Bayesian analyses in clinical research”</a></h2>
<p>This section provides the code from the published paper in R. The dataset for the paper is included in the corresponding <a href="https://github.com/nichole-carlson/BayesianClinicalResearch">GitHub repository hosted by Dr.&nbsp;Nichole Carlson</a>, but can also be downloaded as CSV here for convenience: <a href="./files/drugtrial.csv">drugtrial.csv</a>.</p>
<p>For simplicity, we focus on comparing priors across simple linear regression models, but the <a href="https://github.com/nichole-carlson/BayesianClinicalResearch">GitHub repository</a> includes examples for multiple linear regression and logistic regression models as well. In this example, we have a continuous outcome of time to readiness for discharge (in minutes) that are compared by two randomized treatment groups (sufentanil (new treatment) versus IV fentanyl).</p>
<p>First, let’s load our packages and read in our data:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CALL LIBRARIES</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms) <span class="co">#Bayesian modeling capabilities</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR) <span class="co">#particular Bayesian tests</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># READ IN CLINICAL TRIAL DATA FROM PAPER</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>trial <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'../files/drugtrial.csv'</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">### CHECK OUT TOP ROWS OF DATA</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">## trial mini-data dictionary:</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># rowid: trial ID</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># in_phase_1_to_out_of_phase_2: time to readiness for discharge after arrival in PACU (minutes)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># sex_n: sex of participant (1=female, 0=male)</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># groupn: randomized group (1=sufentanil, 0=IV fentanyl)</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># blockn: preoperative nerve block used (1=yes, 0=no)</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># proc_length_center: procedure length (minutes)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(trial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  rowid in_phase_1_to_out_of_phase_2 sex_n groupn blockn proc_length_center
1     1                           60     1      0      0              -37.8
2     2                           69     1      1      1              -10.8
3     3                          102     1      1      0              -57.8
4     4                          165     1      0      0               22.2
5     5                          115     1      1      0              140.2
6     6                          104     0      0      1               21.2</code></pre>
</div>
</div>
<section id="frequentist-simple-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="frequentist-simple-linear-regression">Frequentist Simple Linear Regression</h3>
<p>For comparison sake, we can first fit our frequentist simple linear regression using the <code>glm</code> function:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax: &lt;name of model object&gt; &lt;- glm(&lt;outcome variable&gt; ~ &lt;predictor variable&gt;, data = &lt;datasetname&gt;, family=&lt;distribution corresponding to model type&gt;) </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>lin_reg <span class="ot">&lt;-</span> <span class="fu">glm</span>(in_phase_1_to_out_of_phase_2 <span class="sc">~</span> groupn, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>trial, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">family=</span><span class="st">'gaussian'</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax: summary(&lt;model object&gt;) - function to show model parameter estimates/results</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lin_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = in_phase_1_to_out_of_phase_2 ~ groupn, family = "gaussian", 
    data = trial)

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   94.364      5.289  17.842   &lt;2e-16 ***
groupn         3.727      7.480   0.498     0.62    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 923.0682)

    Null deviance: 59306  on 65  degrees of freedom
Residual deviance: 59076  on 64  degrees of freedom
AIC: 641.9

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax: confint() - print confidence intervals in console</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lin_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %   97.5 %
(Intercept)  83.99771 104.7296
groupn      -10.93236  18.3869</code></pre>
</div>
</div>
</section>
<section id="brms-bayesian-simple-linear-regression-syntax" class="level3">
<h3 class="anchored" data-anchor-id="brms-bayesian-simple-linear-regression-syntax">brms Bayesian Simple Linear Regression Syntax</h3>
<p>The general syntax for using <code>brm</code> is described below:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax: using brm function for Bayesian modeling</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   &lt;name of model object&gt; &lt;- brm(&lt;outcome variable&gt; ~ &lt;predictor variable&gt;, </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#            data = &lt;datasetname&gt;, </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#            family=&lt;distribution corresponding to model type&gt;,</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#            prior = c(set_prior("&lt;distribution(mean,SD)", class = "&lt;name&gt;")),</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#            seed = &lt;value - for reproducibility&gt;,</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#            init = &lt;name of initial values list&gt;,</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#            warmup = &lt;sets the # of burn-in iterations (those that will be 'thrown out')&gt;,</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#            iter = &lt;# of total iterations for each chain including burn-in&gt;</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#            chains = &lt;# of chains&gt;,</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#            cores = &lt;#&gt; to use for executing chains in parallel - for processing)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We also will create a set of initial values to use for each our simple linear regressions below:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set initial starting values for chains by creating a list, will be used for all simple linear regressions</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax: list(&lt;model parameter&gt; = &lt;starting value&gt;); be sure to list all parameters</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Intercept =</span> <span class="dv">0</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma     =</span> <span class="dv">1</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta      =</span> <span class="dv">0</span> )</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax: &lt;new_list&gt; &lt;- list(&lt;initial values list name&gt;) - Create list of all initial values</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>list_of_inits <span class="ot">&lt;-</span> <span class="fu">list</span>(inits, inits, inits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="brms-slr-with-pseudo-vague-prior" class="level3">
<h3 class="anchored" data-anchor-id="brms-slr-with-pseudo-vague-prior">brms SLR with Pseudo Vague Prior</h3>
<p>In this example, we fit a “pseudo-vague” prior where <span class="math inline">\(\sigma^2 = 1000\)</span> or, equivalently, <span class="math inline">\(\sigma = \sqrt{1000} = 31.62278\)</span>. Here we call the prior “pseudo-vague” because it turns out that while it seems like a <em>large</em> variance, since <span class="math inline">\(\beta_0 \sim N(\mu=0, \sigma=31.62278)\)</span>, there is some biasing towards a mean of 0.</p>
<div class="cell" data-hash="index_cache/html/brms-slr-pseudo-vague-prior_6341080c9a4242ad19b7ecca3d50aece">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fit_lin_1 <span class="ot">&lt;-</span><span class="fu">brm</span>(in_phase_1_to_out_of_phase_2 <span class="sc">~</span> groupn,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>trial,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">family=</span><span class="st">'gaussian'</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">set_prior</span>(<span class="st">"normal(0,31.62278)"</span>, <span class="at">class =</span> <span class="st">"b"</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">set_prior</span>(<span class="st">"normal(0,31.62278)"</span>, <span class="at">class =</span><span class="st">"Intercept"</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">set_prior</span>(<span class="st">"inv_gamma(0.01,0.01)"</span>, <span class="at">class=</span><span class="st">"sigma"</span>)),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">seed=</span> <span class="dv">123</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">init=</span>list_of_inits,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">10000</span>, <span class="at">chains =</span> <span class="dv">2</span>, <span class="at">cores=</span><span class="dv">4</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize parameters</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_lin_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: in_phase_1_to_out_of_phase_2 ~ groupn 
   Data: trial (Number of observations: 66) 
  Draws: 2 chains, each with iter = 10000; warmup = 1000; thin = 1;
         total post-warmup draws = 18000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept    93.05      5.34    82.48   103.53 1.00    18799    13379
groupn        3.55      7.42   -10.90    18.16 1.00    17970    13260

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    30.71      2.75    25.89    36.59 1.00    19382    13421

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain highest density posterior interval</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>bayestestR<span class="sc">::</span><span class="fu">hdi</span>(fit_lin_1, <span class="at">ci=</span><span class="fl">0.95</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Highest Density Interval

Parameter   |          95% HDI
------------------------------
(Intercept) | [ 82.66, 103.66]
groupn      | [-10.79,  18.24]</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax: plot() - print Bayesian diagnostic plots to console, plots in one figure</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_lin_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/brms-slr-pseudo-vague-prior-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Request plots individually </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_1, <span class="at">type=</span><span class="st">"hist"</span>) <span class="co">#histogram</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/brms-slr-pseudo-vague-prior-2.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_1, <span class="at">type=</span><span class="st">"trace"</span>) <span class="co">#trace plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/brms-slr-pseudo-vague-prior-3.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_1, <span class="at">type=</span><span class="st">"acf"</span>) <span class="co">#autocorrelation plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/brms-slr-pseudo-vague-prior-4.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax: prior_summary() - print priors used in console</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(fit_lin_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                prior     class   coef group resp dpar nlpar lb ub       source
   normal(0,31.62278)         b                                            user
   normal(0,31.62278)         b groupn                             (vectorized)
   normal(0,31.62278) Intercept                                            user
 inv_gamma(0.01,0.01)     sigma                               0            user</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior chains</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>post_samp <span class="ot">&lt;-</span> <span class="fu">as_draws</span>(fit_lin_1)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine and extract drug group posterior estimates (can add more list items if more than 2 chains)</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>xpost <span class="ot">&lt;-</span> <span class="fu">c</span>(post_samp[[<span class="dv">1</span>]]<span class="sc">$</span>b_groupn, post_samp[[<span class="dv">2</span>]]<span class="sc">$</span>b_groupn) </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the posterior probability that our group predictor is less than 0</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(xpost <span class="sc">&lt;</span> <span class="dv">0</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3167222</code></pre>
</div>
</div>
</section>
<section id="brms-slr-with-vague-prior" class="level3">
<h3 class="anchored" data-anchor-id="brms-slr-with-vague-prior">brms SLR with Vague Prior</h3>
<p>In this example, we fit a “vague” prior where <span class="math inline">\(\sigma^2 = 10000\)</span> or, equivalently, <span class="math inline">\(\sigma = \sqrt{100} = 100\)</span>.</p>
<div class="cell" data-hash="index_cache/html/brms-slr-vague-prior_c89a83358dcccf25fc0ef8f0135c4369">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fit_lin_2 <span class="ot">&lt;-</span> <span class="fu">brm</span>(in_phase_1_to_out_of_phase_2 <span class="sc">~</span> groupn, </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>trial, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family=</span><span class="st">'gaussian'</span>, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">set_prior</span>(<span class="st">"normal(0,100)"</span>, <span class="at">class =</span> <span class="st">"b"</span>),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">set_prior</span>(<span class="st">"normal(0,100)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">set_prior</span>(<span class="st">"inv_gamma(0.01,0.01)"</span>, <span class="at">class=</span><span class="st">"sigma"</span>)),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed=</span> <span class="dv">123</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">init=</span>list_of_inits,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">10000</span>, <span class="at">chains =</span> <span class="dv">2</span>, <span class="at">cores=</span><span class="dv">4</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_lin_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: in_phase_1_to_out_of_phase_2 ~ groupn 
   Data: trial (Number of observations: 66) 
  Draws: 2 chains, each with iter = 10000; warmup = 1000; thin = 1;
         total post-warmup draws = 18000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept    94.28      5.43    83.71   105.04 1.00    16878    12729
groupn        3.63      7.60   -11.51    18.32 1.00    17708    11472

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    30.74      2.75    25.89    36.61 1.00    17210    13095

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>bayestestR<span class="sc">::</span><span class="fu">hdi</span>(fit_lin_2, <span class="at">ci=</span><span class="fl">0.95</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Highest Density Interval

Parameter   |          95% HDI
------------------------------
(Intercept) | [ 83.20, 104.45]
groupn      | [-11.06,  18.71]</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_lin_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/brms-slr-vague-prior-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_2, <span class="at">type=</span><span class="st">"hist"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/brms-slr-vague-prior-2.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_2, <span class="at">type=</span><span class="st">"trace"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/brms-slr-vague-prior-3.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_2, <span class="at">type=</span><span class="st">"acf"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/brms-slr-vague-prior-4.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(fit_lin_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                prior     class   coef group resp dpar nlpar lb ub       source
        normal(0,100)         b                                            user
        normal(0,100)         b groupn                             (vectorized)
        normal(0,100) Intercept                                            user
 inv_gamma(0.01,0.01)     sigma                               0            user</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OPTION 1 for calculating posterior probabilities:</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior chains</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>post_samp2 <span class="ot">&lt;-</span> <span class="fu">as_draws</span>(fit_lin_2)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>xpost2 <span class="ot">&lt;-</span> <span class="fu">c</span>(post_samp2[[<span class="dv">1</span>]]<span class="sc">$</span>b_groupn, post_samp2[[<span class="dv">2</span>]]<span class="sc">$</span>b_groupn) </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the posterior probability that our group predictor is less than 0</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(xpost2 <span class="sc">&lt;</span> <span class="dv">0</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3117778</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OPTION 2 for calculating posterior probabilities:</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior chains</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>post_samp2 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_lin_2)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an indicator for group &lt; 0</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>post_samp2<span class="sc">$</span>indicator <span class="ot">&lt;-</span> post_samp2<span class="sc">$</span>b_groupn<span class="sc">&lt;</span><span class="dv">0</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the posterior probability</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(post_samp2<span class="sc">$</span>indicator)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Mode   FALSE    TRUE 
logical   12388    5612 </code></pre>
</div>
</div>
</section>
<section id="brms-slr-with-optimistic-prior" class="level3">
<h3 class="anchored" data-anchor-id="brms-slr-with-optimistic-prior">brms SLR with Optimistic Prior</h3>
<p>In this example, we fit an “optimistic” prior on our treatment group such that <span class="math inline">\(\beta_1 \sim N(\mu=-30, \sigma=10)\)</span>. This was selected based on the estimates used for the power analysis in the original trial where it was estimated that a clinically meaningful difference would be a 30 minute reduction in readiness to discharge.</p>
<div class="cell" data-hash="index_cache/html/brms-slr-optimistic-prior_5421be8063a0f05e28e9d71aa1098a07">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fit_lin_3 <span class="ot">&lt;-</span> <span class="fu">brm</span>(in_phase_1_to_out_of_phase_2 <span class="sc">~</span> groupn, </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>trial, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family=</span><span class="st">'gaussian'</span>, </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">set_prior</span>(<span class="st">"normal(-30,10)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"groupn"</span>),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">set_prior</span>(<span class="st">"normal(0,100)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">set_prior</span>(<span class="st">"inv_gamma(0.01,0.01)"</span>, <span class="at">class=</span><span class="st">"sigma"</span>)),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed=</span> <span class="dv">123</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">init=</span>list_of_inits,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">10000</span>, <span class="at">chains =</span> <span class="dv">2</span>, <span class="at">cores=</span><span class="dv">4</span>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_lin_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: in_phase_1_to_out_of_phase_2 ~ groupn 
   Data: trial (Number of observations: 66) 
  Draws: 2 chains, each with iter = 10000; warmup = 1000; thin = 1;
         total post-warmup draws = 18000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   100.48      4.99    90.87   110.33 1.00    14460    12578
groupn       -8.79      6.24   -21.28     3.14 1.00    14788    12967

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    31.33      2.86    26.32    37.54 1.00    15824    13469

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>bayestestR<span class="sc">::</span><span class="fu">hdi</span>(fit_lin_3, <span class="at">ci=</span><span class="fl">0.95</span>) <span class="co">#get 95% HDP Credible Intervals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Highest Density Interval

Parameter   |          95% HDI
------------------------------
(Intercept) | [ 90.51, 109.89]
groupn      | [-20.89,   3.41]</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_lin_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/brms-slr-optimistic-prior-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_3, <span class="at">type=</span><span class="st">"hist"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/brms-slr-optimistic-prior-2.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_3, <span class="at">type=</span><span class="st">"trace"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/brms-slr-optimistic-prior-3.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_3, <span class="at">type=</span><span class="st">"acf"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/brms-slr-optimistic-prior-4.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(fit_lin_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                prior     class   coef group resp dpar nlpar lb ub  source
               (flat)         b                                    default
       normal(-30,10)         b groupn                                user
        normal(0,100) Intercept                                       user
 inv_gamma(0.01,0.01)     sigma                               0       user</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior chains</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>post_samp3 <span class="ot">&lt;-</span> <span class="fu">as_draws</span>(fit_lin_3)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>xpost3 <span class="ot">&lt;-</span> <span class="fu">c</span>(post_samp3[[<span class="dv">1</span>]]<span class="sc">$</span>b_groupn, post_samp3[[<span class="dv">2</span>]]<span class="sc">$</span>b_groupn) </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the posterior probability that our group predictor is less than 0</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(xpost3 <span class="sc">&lt;</span> <span class="dv">0</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9235</code></pre>
</div>
</div>
</section>
<section id="brms-slr-with-skeptical-prior" class="level3">
<h3 class="anchored" data-anchor-id="brms-slr-with-skeptical-prior">brms SLR with Skeptical Prior</h3>
<p>In this example, we fit a “skeptical” prior on our treatment group such that <span class="math inline">\(\beta_1 \sim N(\mu=0, \sigma=10)\)</span>. This prior represents a skeptics belief that there is a meaningful treatment difference by centering the treatment effect at 0 with smaller variance than our vague prior.</p>
<div class="cell" data-hash="index_cache/html/brms-slr-skeptical-prior_f54dfb92a58de2cf6368f1a087582025">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>fit_lin_4 <span class="ot">&lt;-</span> <span class="fu">brm</span>(in_phase_1_to_out_of_phase_2 <span class="sc">~</span> groupn, </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>trial, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family=</span><span class="st">'gaussian'</span>, </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">set_prior</span>(<span class="st">"normal(0,10)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"groupn"</span>),</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">set_prior</span>(<span class="st">"normal(0,100)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">set_prior</span>(<span class="st">"inv_gamma(0.01,0.01)"</span>, <span class="at">class=</span><span class="st">"sigma"</span>)),</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed=</span> <span class="dv">123</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">init=</span>list_of_inits,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">10000</span>, <span class="at">chains =</span> <span class="dv">2</span>, <span class="at">cores=</span><span class="dv">4</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_lin_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: in_phase_1_to_out_of_phase_2 ~ groupn 
   Data: trial (Number of observations: 66) 
  Draws: 2 chains, each with iter = 10000; warmup = 1000; thin = 1;
         total post-warmup draws = 18000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept    94.95      4.92    85.27   104.53 1.00    18329    12418
groupn        2.27      5.98    -9.59    14.05 1.00    17125    13003

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    30.66      2.73    25.90    36.53 1.00    16139    13918

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>bayestestR<span class="sc">::</span><span class="fu">hdi</span>(fit_lin_4, <span class="at">ci=</span><span class="fl">0.95</span>) <span class="co">#get 95% HDP Credible Intervals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Highest Density Interval

Parameter   |         95% HDI
-----------------------------
(Intercept) | [85.18, 104.41]
groupn      | [-9.22,  14.32]</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_lin_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/brms-slr-skeptical-prior-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_4, <span class="at">type=</span><span class="st">"hist"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/brms-slr-skeptical-prior-2.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_4, <span class="at">type=</span><span class="st">"trace"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/brms-slr-skeptical-prior-3.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_4, <span class="at">type=</span><span class="st">"acf"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/brms-slr-skeptical-prior-4.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(fit_lin_4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                prior     class   coef group resp dpar nlpar lb ub  source
               (flat)         b                                    default
         normal(0,10)         b groupn                                user
        normal(0,100) Intercept                                       user
 inv_gamma(0.01,0.01)     sigma                               0       user</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior chains</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>post_samp4 <span class="ot">&lt;-</span> <span class="fu">as_draws</span>(fit_lin_4)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>xpost4 <span class="ot">&lt;-</span> <span class="fu">c</span>(post_samp4[[<span class="dv">1</span>]]<span class="sc">$</span>b_groupn, post_samp4[[<span class="dv">2</span>]]<span class="sc">$</span>b_groupn) </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the posterior probability that our group predictor is less than 0</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(xpost4 <span class="sc">&lt;</span> <span class="dv">0</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3480556</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p>Below are some references to highlight based on the slides and code:</p>
<ul>
<li><a href="https://www.cambridge.org/core/journals/journal-of-clinical-and-translational-science/article/practical-guide-to-adopting-bayesian-analyses-in-clinical-research/CF6C017318CD5431C98EEFE37DBB6063?utm_campaign=shareaholic&amp;utm_medium=copy_link&amp;utm_source=bookmark">A practical guide to adopting Bayesian analyses in clinical research</a>: 2024 tutorial paper exploring the Bayesian approach to statistics and how to apply the methods for clinical trials</li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb59" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Bayesian 101"</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="an">toc_float:</span><span class="co"> true</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="an">toc-location:</span><span class="co"> left</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap </span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo = FALSE}</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">message =</span> <span class="cn">FALSE</span>,</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">echo =</span> <span class="cn">TRUE</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="fu"># Overview</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>This module covers a crash course in Bayesian statistics. While many adaptive trial elements can be done with frequentist methods, Bayesian methods provide additional flexibility. We will introduce the basics of the Bayesian approach to statistics and cover a brief example analysis of a clinical trial using Bayesian methods.</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a><span class="fu"># Slide Deck</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;iframe</span> <span class="er">class</span><span class="ot">=</span><span class="st">"speakerdeck-iframe"</span> <span class="er">style</span><span class="ot">=</span><span class="st">"border: 0px; background: rgba(0, 0, 0, 0.1) padding-box; margin: 0px; padding: 0px; border-radius: 6px; box-shadow: rgba(0, 0, 0, 0.2) 0px 5px 40px; width: 100%; height: auto; aspect-ratio: 560 / 315;"</span> <span class="er">frameborder</span><span class="ot">=</span><span class="st">"0"</span> <span class="er">src</span><span class="ot">=</span><span class="st">"https://speakerdeck.com/player/9e2562ed178d47419175ba3647883c01"</span> <span class="er">title</span><span class="ot">=</span><span class="st">"Bayesian 101"</span> <span class="er">allowfullscreen</span><span class="ot">=</span><span class="st">"true"</span> <span class="er">data-ratio</span><span class="ot">=</span><span class="st">"1.7777777777777777"</span><span class="kw">&gt;</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/iframe&gt;</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>You can also download the <span class="co">[</span><span class="ot">original PowerPoint file</span><span class="co">](../files/Slides/2_intro_bayesian.pptx)</span>.</span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a><span class="fu"># Code Examples in R</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## Software Options</span></span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>There are lots of statistical packages and approaches that we can use to either run Bayesian models in R, or to connect R with external software to implement the models. Some options include:</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`brms` package</span><span class="co">](https://paul-buerkner.github.io/brms/)</span>: implements the Stan programming language within R, syntax is similar to the <span class="in">`lme4`</span> package, this is our focus for Bayesian examples</span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`rstan` and `rstanarm` packages</span><span class="co">](https://mc-stan.org/users/interfaces/rstan)</span>: implements the Stan programming language within R, <span class="in">`rstanarm`</span> uses standard <span class="in">`glm`</span> syntax, runs more quickly than <span class="in">`brms`</span> since models are pre-compiled</span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`bayestestr` package</span><span class="co">](https://easystats.github.io/bayestestR/)</span>: can provide Bayes factors and works with <span class="in">`rstanarm`</span>, <span class="in">`brms`</span>, and <span class="in">`BayesFactor`</span></span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">`R2jags`</span><span class="co">](https://cran.r-project.org/web/packages/R2jags/index.html)</span>, <span class="co">[</span><span class="ot">`rjags`</span><span class="co">](https://cran.r-project.org/web/packages/rjags/index.html)</span>, <span class="co">[</span><span class="ot">`runjags`</span><span class="co">](https://cran.r-project.org/web/packages/runjags/index.html)</span> packages: implements <span class="co">[</span><span class="ot">JAGS (just another Gibbs sampler)</span><span class="co">](https://mcmc-jags.sourceforge.io/)</span> which allows for non-gradient sampling, JAGS is one of the "original" approaches for implementing Bayesian analyses via software (that I remember), can be a little clunkier than other options</span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>It is worth noting that within each software distributions may use different parameterizations, so caution should be taken to ensure the desired prior values are used. For example, the normal distribution in JAGS uses the precision (i.e., $\tau = \frac{1}{\sigma^2}$), whereas Stan uses the standard deviation (i.e., $\sigma$).</span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a>Dr. Kruschke has a nice introduction to Bayesian textbook that includes some <span class="co">[</span><span class="ot">instructions for installing software for Bayesian analyses</span><span class="co">](https://sites.google.com/site/doingbayesiandataanalysis/software-installation)</span>. You may also be interested in exploring the textbook for more background on Bayesian theory, methods, and implementation.</span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a>Additionally, Stata and SAS (e.g., PROC MCMC and PROC GENMOD) include Bayesian options. These are detailed in <span class="co">[</span><span class="ot">"A practical guide to adopting Bayesian analyses in clinical research"</span><span class="co">](https://www.cambridge.org/core/journals/journal-of-clinical-and-translational-science/article/practical-guide-to-adopting-bayesian-analyses-in-clinical-research/CF6C017318CD5431C98EEFE37DBB6063?utm_campaign=shareaholic&amp;utm_medium=copy_link&amp;utm_source=bookmark)</span> for step-by-step guidance on their implementation.</span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linear Regression Code from ["A practical guide to adopting Bayesian analyses in clinical research"](https://www.cambridge.org/core/journals/journal-of-clinical-and-translational-science/article/practical-guide-to-adopting-bayesian-analyses-in-clinical-research/CF6C017318CD5431C98EEFE37DBB6063?utm_campaign=shareaholic&amp;utm_medium=copy_link&amp;utm_source=bookmark)</span></span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-54"><a href="#cb59-54" aria-hidden="true" tabindex="-1"></a>This section provides the code from the published paper in R. The dataset for the paper is included in the corresponding <span class="co">[</span><span class="ot">GitHub repository hosted by Dr. Nichole Carlson</span><span class="co">](https://github.com/nichole-carlson/BayesianClinicalResearch)</span>, but can also be downloaded as CSV here for convenience: <span class="co">[</span><span class="ot">drugtrial.csv</span><span class="co">](./files/drugtrial.csv)</span>.</span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a>For simplicity, we focus on comparing priors across simple linear regression models, but the <span class="co">[</span><span class="ot">GitHub repository</span><span class="co">](https://github.com/nichole-carlson/BayesianClinicalResearch)</span> includes examples for multiple linear regression and logistic regression models as well. In this example, we have a continuous outcome of time to readiness for discharge (in minutes) that are compared by two randomized treatment groups (sufentanil (new treatment) versus IV fentanyl).</span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a>First, let's load our packages and read in our data:</span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=F}</span></span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a><span class="co"># CALL LIBRARIES</span></span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms) <span class="co">#Bayesian modeling capabilities</span></span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR) <span class="co">#particular Bayesian tests</span></span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a><span class="co"># READ IN CLINICAL TRIAL DATA FROM PAPER</span></span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a>trial <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'../files/drugtrial.csv'</span>)</span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-68"><a href="#cb59-68" aria-hidden="true" tabindex="-1"></a><span class="do">### CHECK OUT TOP ROWS OF DATA</span></span>
<span id="cb59-69"><a href="#cb59-69" aria-hidden="true" tabindex="-1"></a><span class="do">## trial mini-data dictionary:</span></span>
<span id="cb59-70"><a href="#cb59-70" aria-hidden="true" tabindex="-1"></a><span class="co"># rowid: trial ID</span></span>
<span id="cb59-71"><a href="#cb59-71" aria-hidden="true" tabindex="-1"></a><span class="co"># in_phase_1_to_out_of_phase_2: time to readiness for discharge after arrival in PACU (minutes)</span></span>
<span id="cb59-72"><a href="#cb59-72" aria-hidden="true" tabindex="-1"></a><span class="co"># sex_n: sex of participant (1=female, 0=male)</span></span>
<span id="cb59-73"><a href="#cb59-73" aria-hidden="true" tabindex="-1"></a><span class="co"># groupn: randomized group (1=sufentanil, 0=IV fentanyl)</span></span>
<span id="cb59-74"><a href="#cb59-74" aria-hidden="true" tabindex="-1"></a><span class="co"># blockn: preoperative nerve block used (1=yes, 0=no)</span></span>
<span id="cb59-75"><a href="#cb59-75" aria-hidden="true" tabindex="-1"></a><span class="co"># proc_length_center: procedure length (minutes)</span></span>
<span id="cb59-76"><a href="#cb59-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-77"><a href="#cb59-77" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(trial)</span>
<span id="cb59-78"><a href="#cb59-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-79"><a href="#cb59-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-80"><a href="#cb59-80" aria-hidden="true" tabindex="-1"></a><span class="fu">### Frequentist Simple Linear Regression</span></span>
<span id="cb59-81"><a href="#cb59-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-82"><a href="#cb59-82" aria-hidden="true" tabindex="-1"></a>For comparison sake, we can first fit our frequentist simple linear regression using the <span class="in">`glm`</span> function:</span>
<span id="cb59-83"><a href="#cb59-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-86"><a href="#cb59-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-87"><a href="#cb59-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax: &lt;name of model object&gt; &lt;- glm(&lt;outcome variable&gt; ~ &lt;predictor variable&gt;, data = &lt;datasetname&gt;, family=&lt;distribution corresponding to model type&gt;) </span></span>
<span id="cb59-88"><a href="#cb59-88" aria-hidden="true" tabindex="-1"></a>lin_reg <span class="ot">&lt;-</span> <span class="fu">glm</span>(in_phase_1_to_out_of_phase_2 <span class="sc">~</span> groupn, </span>
<span id="cb59-89"><a href="#cb59-89" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>trial, </span>
<span id="cb59-90"><a href="#cb59-90" aria-hidden="true" tabindex="-1"></a>               <span class="at">family=</span><span class="st">'gaussian'</span>)</span>
<span id="cb59-91"><a href="#cb59-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-92"><a href="#cb59-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax: summary(&lt;model object&gt;) - function to show model parameter estimates/results</span></span>
<span id="cb59-93"><a href="#cb59-93" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lin_reg)</span>
<span id="cb59-94"><a href="#cb59-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-95"><a href="#cb59-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax: confint() - print confidence intervals in console</span></span>
<span id="cb59-96"><a href="#cb59-96" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lin_reg)</span>
<span id="cb59-97"><a href="#cb59-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-98"><a href="#cb59-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-99"><a href="#cb59-99" aria-hidden="true" tabindex="-1"></a><span class="fu">### brms Bayesian Simple Linear Regression Syntax</span></span>
<span id="cb59-100"><a href="#cb59-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-101"><a href="#cb59-101" aria-hidden="true" tabindex="-1"></a>The general syntax for using <span class="in">`brm`</span> is described below:</span>
<span id="cb59-102"><a href="#cb59-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-105"><a href="#cb59-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-106"><a href="#cb59-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax: using brm function for Bayesian modeling</span></span>
<span id="cb59-107"><a href="#cb59-107" aria-hidden="true" tabindex="-1"></a><span class="co">#   &lt;name of model object&gt; &lt;- brm(&lt;outcome variable&gt; ~ &lt;predictor variable&gt;, </span></span>
<span id="cb59-108"><a href="#cb59-108" aria-hidden="true" tabindex="-1"></a><span class="co">#            data = &lt;datasetname&gt;, </span></span>
<span id="cb59-109"><a href="#cb59-109" aria-hidden="true" tabindex="-1"></a><span class="co">#            family=&lt;distribution corresponding to model type&gt;,</span></span>
<span id="cb59-110"><a href="#cb59-110" aria-hidden="true" tabindex="-1"></a><span class="co">#            prior = c(set_prior("&lt;distribution(mean,SD)", class = "&lt;name&gt;")),</span></span>
<span id="cb59-111"><a href="#cb59-111" aria-hidden="true" tabindex="-1"></a><span class="co">#            seed = &lt;value - for reproducibility&gt;,</span></span>
<span id="cb59-112"><a href="#cb59-112" aria-hidden="true" tabindex="-1"></a><span class="co">#            init = &lt;name of initial values list&gt;,</span></span>
<span id="cb59-113"><a href="#cb59-113" aria-hidden="true" tabindex="-1"></a><span class="co">#            warmup = &lt;sets the # of burn-in iterations (those that will be 'thrown out')&gt;,</span></span>
<span id="cb59-114"><a href="#cb59-114" aria-hidden="true" tabindex="-1"></a><span class="co">#            iter = &lt;# of total iterations for each chain including burn-in&gt;</span></span>
<span id="cb59-115"><a href="#cb59-115" aria-hidden="true" tabindex="-1"></a><span class="co">#            chains = &lt;# of chains&gt;,</span></span>
<span id="cb59-116"><a href="#cb59-116" aria-hidden="true" tabindex="-1"></a><span class="co">#            cores = &lt;#&gt; to use for executing chains in parallel - for processing)</span></span>
<span id="cb59-117"><a href="#cb59-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-118"><a href="#cb59-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-119"><a href="#cb59-119" aria-hidden="true" tabindex="-1"></a>We also will create a set of initial values to use for each our simple linear regressions below:</span>
<span id="cb59-120"><a href="#cb59-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-123"><a href="#cb59-123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-124"><a href="#cb59-124" aria-hidden="true" tabindex="-1"></a><span class="co"># Set initial starting values for chains by creating a list, will be used for all simple linear regressions</span></span>
<span id="cb59-125"><a href="#cb59-125" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax: list(&lt;model parameter&gt; = &lt;starting value&gt;); be sure to list all parameters</span></span>
<span id="cb59-126"><a href="#cb59-126" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb59-127"><a href="#cb59-127" aria-hidden="true" tabindex="-1"></a>  <span class="at">Intercept =</span> <span class="dv">0</span>,</span>
<span id="cb59-128"><a href="#cb59-128" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma     =</span> <span class="dv">1</span>,</span>
<span id="cb59-129"><a href="#cb59-129" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta      =</span> <span class="dv">0</span> )</span>
<span id="cb59-130"><a href="#cb59-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-131"><a href="#cb59-131" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax: &lt;new_list&gt; &lt;- list(&lt;initial values list name&gt;) - Create list of all initial values</span></span>
<span id="cb59-132"><a href="#cb59-132" aria-hidden="true" tabindex="-1"></a>list_of_inits <span class="ot">&lt;-</span> <span class="fu">list</span>(inits, inits, inits)</span>
<span id="cb59-133"><a href="#cb59-133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-134"><a href="#cb59-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-135"><a href="#cb59-135" aria-hidden="true" tabindex="-1"></a><span class="fu">### brms SLR with Pseudo Vague Prior</span></span>
<span id="cb59-136"><a href="#cb59-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-137"><a href="#cb59-137" aria-hidden="true" tabindex="-1"></a>In this example, we fit a "pseudo-vague" prior where $\sigma^2 = 1000$ or, equivalently, $\sigma = \sqrt{1000} = 31.62278$. Here we call the prior "pseudo-vague" because it turns out that while it seems like a *large* variance, since $\beta_0 \sim N(\mu=0, \sigma=31.62278)$, there is some biasing towards a mean of 0.</span>
<span id="cb59-138"><a href="#cb59-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-139"><a href="#cb59-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r brms-slr-pseudo-vague-prior, cache=T}</span></span>
<span id="cb59-140"><a href="#cb59-140" aria-hidden="true" tabindex="-1"></a>fit_lin_1 <span class="ot">&lt;-</span><span class="fu">brm</span>(in_phase_1_to_out_of_phase_2 <span class="sc">~</span> groupn,</span>
<span id="cb59-141"><a href="#cb59-141" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>trial,</span>
<span id="cb59-142"><a href="#cb59-142" aria-hidden="true" tabindex="-1"></a>                <span class="at">family=</span><span class="st">'gaussian'</span>,</span>
<span id="cb59-143"><a href="#cb59-143" aria-hidden="true" tabindex="-1"></a>                <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">set_prior</span>(<span class="st">"normal(0,31.62278)"</span>, <span class="at">class =</span> <span class="st">"b"</span>),</span>
<span id="cb59-144"><a href="#cb59-144" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">set_prior</span>(<span class="st">"normal(0,31.62278)"</span>, <span class="at">class =</span><span class="st">"Intercept"</span>),</span>
<span id="cb59-145"><a href="#cb59-145" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">set_prior</span>(<span class="st">"inv_gamma(0.01,0.01)"</span>, <span class="at">class=</span><span class="st">"sigma"</span>)),</span>
<span id="cb59-146"><a href="#cb59-146" aria-hidden="true" tabindex="-1"></a>                <span class="at">seed=</span> <span class="dv">123</span>,</span>
<span id="cb59-147"><a href="#cb59-147" aria-hidden="true" tabindex="-1"></a>                <span class="at">init=</span>list_of_inits,</span>
<span id="cb59-148"><a href="#cb59-148" aria-hidden="true" tabindex="-1"></a>                <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">10000</span>, <span class="at">chains =</span> <span class="dv">2</span>, <span class="at">cores=</span><span class="dv">4</span>,</span>
<span id="cb59-149"><a href="#cb59-149" aria-hidden="true" tabindex="-1"></a>                <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>))</span>
<span id="cb59-150"><a href="#cb59-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-151"><a href="#cb59-151" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize parameters</span></span>
<span id="cb59-152"><a href="#cb59-152" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_lin_1)</span>
<span id="cb59-153"><a href="#cb59-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-154"><a href="#cb59-154" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain highest density posterior interval</span></span>
<span id="cb59-155"><a href="#cb59-155" aria-hidden="true" tabindex="-1"></a>bayestestR<span class="sc">::</span><span class="fu">hdi</span>(fit_lin_1, <span class="at">ci=</span><span class="fl">0.95</span>) </span>
<span id="cb59-156"><a href="#cb59-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-157"><a href="#cb59-157" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax: plot() - print Bayesian diagnostic plots to console, plots in one figure</span></span>
<span id="cb59-158"><a href="#cb59-158" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_lin_1)</span>
<span id="cb59-159"><a href="#cb59-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-160"><a href="#cb59-160" aria-hidden="true" tabindex="-1"></a><span class="co"># Request plots individually </span></span>
<span id="cb59-161"><a href="#cb59-161" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_1, <span class="at">type=</span><span class="st">"hist"</span>) <span class="co">#histogram</span></span>
<span id="cb59-162"><a href="#cb59-162" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_1, <span class="at">type=</span><span class="st">"trace"</span>) <span class="co">#trace plot</span></span>
<span id="cb59-163"><a href="#cb59-163" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_1, <span class="at">type=</span><span class="st">"acf"</span>) <span class="co">#autocorrelation plot</span></span>
<span id="cb59-164"><a href="#cb59-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-165"><a href="#cb59-165" aria-hidden="true" tabindex="-1"></a><span class="co"># Syntax: prior_summary() - print priors used in console</span></span>
<span id="cb59-166"><a href="#cb59-166" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(fit_lin_1)</span>
<span id="cb59-167"><a href="#cb59-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-168"><a href="#cb59-168" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior chains</span></span>
<span id="cb59-169"><a href="#cb59-169" aria-hidden="true" tabindex="-1"></a>post_samp <span class="ot">&lt;-</span> <span class="fu">as_draws</span>(fit_lin_1)</span>
<span id="cb59-170"><a href="#cb59-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-171"><a href="#cb59-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine and extract drug group posterior estimates (can add more list items if more than 2 chains)</span></span>
<span id="cb59-172"><a href="#cb59-172" aria-hidden="true" tabindex="-1"></a>xpost <span class="ot">&lt;-</span> <span class="fu">c</span>(post_samp[[<span class="dv">1</span>]]<span class="sc">$</span>b_groupn, post_samp[[<span class="dv">2</span>]]<span class="sc">$</span>b_groupn) </span>
<span id="cb59-173"><a href="#cb59-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-174"><a href="#cb59-174" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the posterior probability that our group predictor is less than 0</span></span>
<span id="cb59-175"><a href="#cb59-175" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(xpost <span class="sc">&lt;</span> <span class="dv">0</span>) </span>
<span id="cb59-176"><a href="#cb59-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-177"><a href="#cb59-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-178"><a href="#cb59-178" aria-hidden="true" tabindex="-1"></a><span class="fu">### brms SLR with Vague Prior</span></span>
<span id="cb59-179"><a href="#cb59-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-180"><a href="#cb59-180" aria-hidden="true" tabindex="-1"></a>In this example, we fit a "vague" prior where $\sigma^2 = 10000$ or, equivalently, $\sigma = \sqrt{100} = 100$.</span>
<span id="cb59-181"><a href="#cb59-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-182"><a href="#cb59-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r brms-slr-vague-prior, cache=T}</span></span>
<span id="cb59-183"><a href="#cb59-183" aria-hidden="true" tabindex="-1"></a>fit_lin_2 <span class="ot">&lt;-</span> <span class="fu">brm</span>(in_phase_1_to_out_of_phase_2 <span class="sc">~</span> groupn, </span>
<span id="cb59-184"><a href="#cb59-184" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>trial, </span>
<span id="cb59-185"><a href="#cb59-185" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family=</span><span class="st">'gaussian'</span>, </span>
<span id="cb59-186"><a href="#cb59-186" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">set_prior</span>(<span class="st">"normal(0,100)"</span>, <span class="at">class =</span> <span class="st">"b"</span>),</span>
<span id="cb59-187"><a href="#cb59-187" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">set_prior</span>(<span class="st">"normal(0,100)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb59-188"><a href="#cb59-188" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">set_prior</span>(<span class="st">"inv_gamma(0.01,0.01)"</span>, <span class="at">class=</span><span class="st">"sigma"</span>)),</span>
<span id="cb59-189"><a href="#cb59-189" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed=</span> <span class="dv">123</span>,</span>
<span id="cb59-190"><a href="#cb59-190" aria-hidden="true" tabindex="-1"></a>                 <span class="at">init=</span>list_of_inits,</span>
<span id="cb59-191"><a href="#cb59-191" aria-hidden="true" tabindex="-1"></a>                 <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">10000</span>, <span class="at">chains =</span> <span class="dv">2</span>, <span class="at">cores=</span><span class="dv">4</span>)</span>
<span id="cb59-192"><a href="#cb59-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-193"><a href="#cb59-193" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_lin_2)</span>
<span id="cb59-194"><a href="#cb59-194" aria-hidden="true" tabindex="-1"></a>bayestestR<span class="sc">::</span><span class="fu">hdi</span>(fit_lin_2, <span class="at">ci=</span><span class="fl">0.95</span>) </span>
<span id="cb59-195"><a href="#cb59-195" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_lin_2)</span>
<span id="cb59-196"><a href="#cb59-196" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_2, <span class="at">type=</span><span class="st">"hist"</span>) </span>
<span id="cb59-197"><a href="#cb59-197" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_2, <span class="at">type=</span><span class="st">"trace"</span>) </span>
<span id="cb59-198"><a href="#cb59-198" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_2, <span class="at">type=</span><span class="st">"acf"</span>) </span>
<span id="cb59-199"><a href="#cb59-199" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(fit_lin_2)</span>
<span id="cb59-200"><a href="#cb59-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-201"><a href="#cb59-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-202"><a href="#cb59-202" aria-hidden="true" tabindex="-1"></a><span class="co"># OPTION 1 for calculating posterior probabilities:</span></span>
<span id="cb59-203"><a href="#cb59-203" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior chains</span></span>
<span id="cb59-204"><a href="#cb59-204" aria-hidden="true" tabindex="-1"></a>post_samp2 <span class="ot">&lt;-</span> <span class="fu">as_draws</span>(fit_lin_2)</span>
<span id="cb59-205"><a href="#cb59-205" aria-hidden="true" tabindex="-1"></a>xpost2 <span class="ot">&lt;-</span> <span class="fu">c</span>(post_samp2[[<span class="dv">1</span>]]<span class="sc">$</span>b_groupn, post_samp2[[<span class="dv">2</span>]]<span class="sc">$</span>b_groupn) </span>
<span id="cb59-206"><a href="#cb59-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-207"><a href="#cb59-207" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the posterior probability that our group predictor is less than 0</span></span>
<span id="cb59-208"><a href="#cb59-208" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(xpost2 <span class="sc">&lt;</span> <span class="dv">0</span>) </span>
<span id="cb59-209"><a href="#cb59-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-210"><a href="#cb59-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-211"><a href="#cb59-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-212"><a href="#cb59-212" aria-hidden="true" tabindex="-1"></a><span class="co"># OPTION 2 for calculating posterior probabilities:</span></span>
<span id="cb59-213"><a href="#cb59-213" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior chains</span></span>
<span id="cb59-214"><a href="#cb59-214" aria-hidden="true" tabindex="-1"></a>post_samp2 <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(fit_lin_2)</span>
<span id="cb59-215"><a href="#cb59-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-216"><a href="#cb59-216" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an indicator for group &lt; 0</span></span>
<span id="cb59-217"><a href="#cb59-217" aria-hidden="true" tabindex="-1"></a>post_samp2<span class="sc">$</span>indicator <span class="ot">&lt;-</span> post_samp2<span class="sc">$</span>b_groupn<span class="sc">&lt;</span><span class="dv">0</span></span>
<span id="cb59-218"><a href="#cb59-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-219"><a href="#cb59-219" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the posterior probability</span></span>
<span id="cb59-220"><a href="#cb59-220" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(post_samp2<span class="sc">$</span>indicator)</span>
<span id="cb59-221"><a href="#cb59-221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-222"><a href="#cb59-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-223"><a href="#cb59-223" aria-hidden="true" tabindex="-1"></a><span class="fu">### brms SLR with Optimistic Prior</span></span>
<span id="cb59-224"><a href="#cb59-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-225"><a href="#cb59-225" aria-hidden="true" tabindex="-1"></a>In this example, we fit an "optimistic" prior on our treatment group such that $\beta_1 \sim N(\mu=-30, \sigma=10)$. This was selected based on the estimates used for the power analysis in the original trial where it was estimated that a clinically meaningful difference would be a 30 minute reduction in readiness to discharge.</span>
<span id="cb59-226"><a href="#cb59-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-227"><a href="#cb59-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r brms-slr-optimistic-prior, cache=T}</span></span>
<span id="cb59-228"><a href="#cb59-228" aria-hidden="true" tabindex="-1"></a>fit_lin_3 <span class="ot">&lt;-</span> <span class="fu">brm</span>(in_phase_1_to_out_of_phase_2 <span class="sc">~</span> groupn, </span>
<span id="cb59-229"><a href="#cb59-229" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>trial, </span>
<span id="cb59-230"><a href="#cb59-230" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family=</span><span class="st">'gaussian'</span>, </span>
<span id="cb59-231"><a href="#cb59-231" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">set_prior</span>(<span class="st">"normal(-30,10)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"groupn"</span>),</span>
<span id="cb59-232"><a href="#cb59-232" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">set_prior</span>(<span class="st">"normal(0,100)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb59-233"><a href="#cb59-233" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">set_prior</span>(<span class="st">"inv_gamma(0.01,0.01)"</span>, <span class="at">class=</span><span class="st">"sigma"</span>)),</span>
<span id="cb59-234"><a href="#cb59-234" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed=</span> <span class="dv">123</span>,</span>
<span id="cb59-235"><a href="#cb59-235" aria-hidden="true" tabindex="-1"></a>                 <span class="at">init=</span>list_of_inits,</span>
<span id="cb59-236"><a href="#cb59-236" aria-hidden="true" tabindex="-1"></a>                 <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">10000</span>, <span class="at">chains =</span> <span class="dv">2</span>, <span class="at">cores=</span><span class="dv">4</span>)</span>
<span id="cb59-237"><a href="#cb59-237" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_lin_3)</span>
<span id="cb59-238"><a href="#cb59-238" aria-hidden="true" tabindex="-1"></a>bayestestR<span class="sc">::</span><span class="fu">hdi</span>(fit_lin_3, <span class="at">ci=</span><span class="fl">0.95</span>) <span class="co">#get 95% HDP Credible Intervals</span></span>
<span id="cb59-239"><a href="#cb59-239" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_lin_3)</span>
<span id="cb59-240"><a href="#cb59-240" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_3, <span class="at">type=</span><span class="st">"hist"</span>) </span>
<span id="cb59-241"><a href="#cb59-241" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_3, <span class="at">type=</span><span class="st">"trace"</span>) </span>
<span id="cb59-242"><a href="#cb59-242" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_3, <span class="at">type=</span><span class="st">"acf"</span>) </span>
<span id="cb59-243"><a href="#cb59-243" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(fit_lin_3)</span>
<span id="cb59-244"><a href="#cb59-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-245"><a href="#cb59-245" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior chains</span></span>
<span id="cb59-246"><a href="#cb59-246" aria-hidden="true" tabindex="-1"></a>post_samp3 <span class="ot">&lt;-</span> <span class="fu">as_draws</span>(fit_lin_3)</span>
<span id="cb59-247"><a href="#cb59-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-248"><a href="#cb59-248" aria-hidden="true" tabindex="-1"></a>xpost3 <span class="ot">&lt;-</span> <span class="fu">c</span>(post_samp3[[<span class="dv">1</span>]]<span class="sc">$</span>b_groupn, post_samp3[[<span class="dv">2</span>]]<span class="sc">$</span>b_groupn) </span>
<span id="cb59-249"><a href="#cb59-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-250"><a href="#cb59-250" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the posterior probability that our group predictor is less than 0</span></span>
<span id="cb59-251"><a href="#cb59-251" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(xpost3 <span class="sc">&lt;</span> <span class="dv">0</span>) </span>
<span id="cb59-252"><a href="#cb59-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-253"><a href="#cb59-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-254"><a href="#cb59-254" aria-hidden="true" tabindex="-1"></a><span class="fu">### brms SLR with Skeptical Prior</span></span>
<span id="cb59-255"><a href="#cb59-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-256"><a href="#cb59-256" aria-hidden="true" tabindex="-1"></a>In this example, we fit a "skeptical" prior on our treatment group such that $\beta_1 \sim N(\mu=0, \sigma=10)$. This prior represents a skeptics belief that there is a meaningful treatment difference by centering the treatment effect at 0 with smaller variance than our vague prior.</span>
<span id="cb59-257"><a href="#cb59-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-258"><a href="#cb59-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r brms-slr-skeptical-prior, cache=T}</span></span>
<span id="cb59-259"><a href="#cb59-259" aria-hidden="true" tabindex="-1"></a>fit_lin_4 <span class="ot">&lt;-</span> <span class="fu">brm</span>(in_phase_1_to_out_of_phase_2 <span class="sc">~</span> groupn, </span>
<span id="cb59-260"><a href="#cb59-260" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>trial, </span>
<span id="cb59-261"><a href="#cb59-261" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family=</span><span class="st">'gaussian'</span>, </span>
<span id="cb59-262"><a href="#cb59-262" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">set_prior</span>(<span class="st">"normal(0,10)"</span>, <span class="at">class =</span> <span class="st">"b"</span>, <span class="at">coef =</span> <span class="st">"groupn"</span>),</span>
<span id="cb59-263"><a href="#cb59-263" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">set_prior</span>(<span class="st">"normal(0,100)"</span>, <span class="at">class =</span> <span class="st">"Intercept"</span>),</span>
<span id="cb59-264"><a href="#cb59-264" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">set_prior</span>(<span class="st">"inv_gamma(0.01,0.01)"</span>, <span class="at">class=</span><span class="st">"sigma"</span>)),</span>
<span id="cb59-265"><a href="#cb59-265" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed=</span> <span class="dv">123</span>,</span>
<span id="cb59-266"><a href="#cb59-266" aria-hidden="true" tabindex="-1"></a>                 <span class="at">init=</span>list_of_inits,</span>
<span id="cb59-267"><a href="#cb59-267" aria-hidden="true" tabindex="-1"></a>                 <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">10000</span>, <span class="at">chains =</span> <span class="dv">2</span>, <span class="at">cores=</span><span class="dv">4</span>)</span>
<span id="cb59-268"><a href="#cb59-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-269"><a href="#cb59-269" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_lin_4)</span>
<span id="cb59-270"><a href="#cb59-270" aria-hidden="true" tabindex="-1"></a>bayestestR<span class="sc">::</span><span class="fu">hdi</span>(fit_lin_4, <span class="at">ci=</span><span class="fl">0.95</span>) <span class="co">#get 95% HDP Credible Intervals</span></span>
<span id="cb59-271"><a href="#cb59-271" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_lin_4)</span>
<span id="cb59-272"><a href="#cb59-272" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_4, <span class="at">type=</span><span class="st">"hist"</span>) </span>
<span id="cb59-273"><a href="#cb59-273" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_4, <span class="at">type=</span><span class="st">"trace"</span>) </span>
<span id="cb59-274"><a href="#cb59-274" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_plot</span>(fit_lin_4, <span class="at">type=</span><span class="st">"acf"</span>) </span>
<span id="cb59-275"><a href="#cb59-275" aria-hidden="true" tabindex="-1"></a><span class="fu">prior_summary</span>(fit_lin_4)</span>
<span id="cb59-276"><a href="#cb59-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-277"><a href="#cb59-277" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract posterior chains</span></span>
<span id="cb59-278"><a href="#cb59-278" aria-hidden="true" tabindex="-1"></a>post_samp4 <span class="ot">&lt;-</span> <span class="fu">as_draws</span>(fit_lin_4)</span>
<span id="cb59-279"><a href="#cb59-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-280"><a href="#cb59-280" aria-hidden="true" tabindex="-1"></a>xpost4 <span class="ot">&lt;-</span> <span class="fu">c</span>(post_samp4[[<span class="dv">1</span>]]<span class="sc">$</span>b_groupn, post_samp4[[<span class="dv">2</span>]]<span class="sc">$</span>b_groupn) </span>
<span id="cb59-281"><a href="#cb59-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-282"><a href="#cb59-282" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the posterior probability that our group predictor is less than 0</span></span>
<span id="cb59-283"><a href="#cb59-283" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(xpost4 <span class="sc">&lt;</span> <span class="dv">0</span>) </span>
<span id="cb59-284"><a href="#cb59-284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-285"><a href="#cb59-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-286"><a href="#cb59-286" aria-hidden="true" tabindex="-1"></a><span class="fu"># References</span></span>
<span id="cb59-287"><a href="#cb59-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-288"><a href="#cb59-288" aria-hidden="true" tabindex="-1"></a>Below are some references to highlight based on the slides and code:</span>
<span id="cb59-289"><a href="#cb59-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-290"><a href="#cb59-290" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">A practical guide to adopting Bayesian analyses in clinical research</span><span class="co">](https://www.cambridge.org/core/journals/journal-of-clinical-and-translational-science/article/practical-guide-to-adopting-bayesian-analyses-in-clinical-research/CF6C017318CD5431C98EEFE37DBB6063?utm_campaign=shareaholic&amp;utm_medium=copy_link&amp;utm_source=bookmark)</span>: 2024 tutorial paper exploring the Bayesian approach to statistics and how to apply the methods for clinical trials</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>